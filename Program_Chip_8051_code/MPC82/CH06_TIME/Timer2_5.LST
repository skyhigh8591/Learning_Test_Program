C51 COMPILER V9.56.0.0   TIMER2_5                                                          03/11/2020 14:00:29 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE TIMER2_5
OBJECT MODULE PLACED IN Timer2_5.OBJ
COMPILER INVOKED BY: C:\Keil_v51\C51\BIN\C51.EXE Timer2_5.C OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /********** Timer2_5.c ****************************
   2          *動作：設定以Timer2計時中斷，若是計時溢位令LED遞加，溢位重新載入
   3          *      若T2EX(P11)腳輸入負緣觸發令LED=0，強迫重新載入
   4          *硬體：P32連接T2EX(P11)，SW1-3(P0LED)ON，按KEY1(P32)
   5          **********************************************/
   6          #include "..\MPC82.H"   //暫存器及組態定義
   7                         //Fosc=22.1184MHz，Timer時脈=Fosc/12=1.8432MHz
   8          #define T  57600  //Timer延時時間=(1/1.8432MHz)*57600=31250uS
   9          
  10          unsigned char i=0;  
  11          main()
  12            {
  13   1         P0M0=0; P0M1=0xFF; //設定P0為推挽式輸出(M0-1=01)
  14   1         //PCON2=5; //Fosc=Fosc/32，時間=31250uS*32=1秒(軟體模擬無效)
  15   1         T2CON = 0x08; /* 0000 1000，由T2EX腳輸入負緣觸發會重新載入
  16   1                          bit3:EXEN2=1,使用外部T2EX接腳
  17   1                    bit1:C/T=0,內部計時 
  18   1                    bit0:CP/RL2=0,重新載入*/
  19   1         RCAP2=T2R=65536-T; //設定Timer2及T2自動載入暫存器
  20   1         TR2 = 1;         //啟動Timer2開始計時
  21   1         EA=1;ET2=1;      //致能Timer2中斷
  22   1         while (1);       //自我空轉，表示此時可作其它工作
  23   1        }
  24          //*****************************************************
  25           void T2_int (void) interrupt 5   //Timer2中斷函數
  26            {
  27   1         if (TF2 ==1)  //若是計時溢位令LED遞加，溢位重新載入
  28   1           {
  29   2             TF2=0;    //清除TF2=0
  30   2             LED=~i++; //LED遞加輸出
  31   2           }
  32   1         else  //若是T2EX腳輸入負緣觸發令LED=0，強迫重新載入
  33   1           {
  34   2             EXF2=0;   //清除EXF2=0
  35   2             i=0;      //i=0
  36   2           LED=~i;
  37   2           }  
  38   1       }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    116    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
