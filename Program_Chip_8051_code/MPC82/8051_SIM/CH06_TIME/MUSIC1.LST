C51 COMPILER V8.17   MUSIC1                                                                09/05/2009 16:17:19 PAGE 1   


C51 COMPILER V8.17, COMPILATION OF MODULE MUSIC1
OBJECT MODULE PLACED IN MUSIC1.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE MUSIC1.C OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /********** music1.c **********************************
   2          *動作：設定以Timer0計時中斷mode1、令喇叭輸出指定音頻
   3          *硬體：SW2-5(SPK)ON
   4          ******************************************************/
   5          #include "..\MPC82.H"   //暫存器及組態定義
   6          
   7          #define  t      22118400/12/2 //T=Fosc/12/2=基本頻率
   8          #define  DO     65536-t/523   //各種音頻的計時器內容
   9          #define  RE     65536-t/587
  10          #define  MI     65536-t/659
  11          #define  FA     65536-t/698
  12          #define  SO     65536-t/785
  13          #define  LA     65536-t/880
  14          #define  SI     65536-t/998          
  15          
  16          unsigned int  code Table[] //音頻的陣列資料 
  17                  = { DO,RE,MI,FA,SO,LA,SI };
  18          unsigned int  Temp;
  19          main()
  20          {
  21   1       char i;
  22   1       EA=1;ET0=1;    //致能Timer0中斷
  23   1       TMOD=0x01;   //設定Timer0的mode1工作
  24   1       while(1)      //重覆執行
  25   1        {
  26   2         for(i=0;i<7;i++) //輸出7個音階
  27   2          {
  28   3           Temp=Table[i]; //讀取陣列音頻資料
  29   3           TL0=Temp; TH0=Temp >> 8; //音頻資料存入計時值     
  30   3           TR0=1;         //啟動Timer0開始計時
  31   3           Delay_ms(500); //延時，發音的時間
  32   3           TR0=0;         //停止Timer0計時 
  33   3          }
  34   2          Delay_ms(1000);   //延時，停止發音的時間
  35   2        }
  36   1      }
  37          /***********************************************/
  38          void T0_int(void) interrupt 1  //Timer0中斷函數
  39          {
  40   1         TL0=Temp;  TH0=Temp >> 8;   //重新設定計時值   
  41   1         SPEAK=!SPEAK;   //喇叭反相發出聲音
  42   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    164    ----
   CONSTANT SIZE    =     14    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      7    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
