C51 COMPILER V8.16   FAST4                                                                 01/13/2009 13:27:45 PAGE 1   


C51 COMPILER V8.16, COMPILATION OF MODULE FAST4
OBJECT MODULE PLACED IN FAST4.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE FAST4.C OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*** FAST4.C*********PCA高速輸出音樂範例************
   2          *動作：PCA高速輸出，PCA中斷控制CEX0(P12)腳輸出音樂
   3          *硬體：SW2-6(SPK)ON
   4          ***********************************************/
   5          #include "..\MPC82.H"   //暫存器及組態定義
   6          #include "music.h"  //音頻定義
   7          unsigned int  code Table[]  //定義音頻陣列資料,0為休止符  
   8             ={DO4,0,RE4,0,MI4,0,FA4,0,SO4,0,LA4,0,SI4,0,DO5,0};
   9          char i;   //資料計數         
  10          unsigned int  Temp;
  11          main()         
  12          {
  13   1        CCAPM0 = ECOM+MAT+TOG+ECCF; //MAT=1，PAC計數與CCAP0匹配時，令CCF0=1
  14   1                                    //ECOM=1，致能比較器功能
  15   1                                                        //TOG=1，(CH:CL)=CCAP0時，令CEX0腳反相
  16   1                                                            //ECCF=1，致能有匹配(CCF0=1)時，產生中斷
  17   1       
  18   1        EA = 1;       //致能所有中斷
  19   1        AUXIE = EPCA; //致能PCA中斷
  20   1        CCF0 = 0;             //清除模組0的比較旗標
  21   1        while (1)     //不斷循環執行
  22   1        {
  23   2         for(i=0; i<16; i++)   //陣列計數由0~15遞加  
  24   2          {
  25   3           if(Table[i]==0) CR = 0; //若資料=0停止PCA計數，停止發音
  26   3                else
  27   3                {     
  28   4                  CCAP0L=Table[i];       //設定比較暫存器低位元組
  29   4              CCAP0H=Table[i]>>8; //設定比較暫存器高位元組
  30   4              CR = 1;             //啟動PCA計數，開始發音
  31   4                }
  32   3           Delay_ms(1000); //延時，發音的時間，等待(CH:CL)=CCAP0產生中斷 
  33   3          }
  34   2        }
  35   1      } 
  36          /***********************************************************
  37          *函數名稱: PCA中斷函數
  38          *功能描述: 自動令CEX0反相
  39          ************************************************************/
  40          void PCA_Interrupt() interrupt 10
  41          {
  42   1        CCF0 = 0;         //清除模組0的比較旗標
  43   1        CL = CH =0;   //PCA計數器由0開始上數
  44   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    203    ----
   CONSTANT SIZE    =     32    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      7    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V8.16   FAST4                                                                 01/13/2009 13:27:45 PAGE 2   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
