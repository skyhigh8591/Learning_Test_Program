C51 COMPILER V9.03   PWM4A                                                                 11/27/2011 15:55:56 PAGE 1   


C51 COMPILER V9.03, COMPILATION OF MODULE PWM4A
OBJECT MODULE PLACED IN PWM4A.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE PWM4A.C OPTIMIZE(2,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /************** PWM4A.C *******ADC與PWM數PWM實習**********
   2          *動作：由ADC控制PWM波形,調整LED亮度音量
   3          *硬體：SW1-4(P1LED)或SW2-6(SPK)ON
   4          *      SW3-1(Ain0)ON，調整Ain0的VR2
   5          *****************************************************/
   6          #include "..\MPC82.H" 
   7          #define  ch     0 //指定由Ain0進行ADC轉換
   8          void main(void)
   9          {
  10   1              P0M0=0; P0M1=0xFF; //設定P0為推挽式輸出(M0-1=01)
  11   1              EA=1;              //致能所有中斷
  12   1          AUXIE = EADC;      //致能ADC中斷
  13   1          ADCTL = ADCON + ADCS + ch; //ADC工作及指定道通進行ADC轉換
  14   1              
  15   1              CCAPM0=ECOM+PWM; //致能CEX0比較器及PWM輸出 
  16   1          CMOD=0x00; //CPS1-0=00,Fpwm=Fosc/12/256=22.1184MHz/12/256=7.2KHz
  17   1              CR=1;      //開始PCA計數
  18   1      
  19   1              while(1);//空轉，表示此時可做其它工作
  20   1      }
  21          
  22          //**************************************************
  23          void ADC_Interrupt()  interrupt 9 
  24          { 
  25   1         ADCTL=0;    //停止ADC工作
  26   1         CCAP0H=ADCH;  //高8-bit數位資料，由PWM輸出
  27   1         Delay_ms(10); 
  28   1         ADCTL = ADCON + ADCS + ch; //重新啟動ADC
  29   1      } 


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    106    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
