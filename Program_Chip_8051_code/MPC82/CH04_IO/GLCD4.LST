C51 COMPILER V9.56.0.0   GLCD4                                                             03/04/2020 10:21:35 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE GLCD4
OBJECT MODULE PLACED IN GLCD4.OBJ
COMPILER INVOKED BY: C:\Keil_v51\C51\BIN\C51.EXE GLCD4.C OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*****GLCD4.C****繪圖型LCD(橫排)實習板範例******
   2          *動作：在繪圖型LCD上顯示小畫家圖形
   3          ****************************************************/
   4          #include "..\MPC82.H"   //暫存器及組態定義
   5          #include "qq.h"  //圖形資料
   6          unsigned char i;  //定義計數變數
   7          unsigned x_page;  //定義LCD顯示X頁位址
   8          int main(void)
   9          {
  10   1         RST=0; Delay_ms(1);RST=1; //重置繪圖型LCD
  11   1        CS1=1;CS2=1;      //開啟繪圖型LCD左右半部
  12   1        Delay_ms(5);      //等待LCD開機時間
  13   1        LCD_Cmd(0x3f);    //0011111D，D=1開啟螢幕
  14   1        CS1=1;CS2=1;LCD_Cmd(0xC0+0); //第0行開始顯示
  15   1        CS1=1; CS2=0;            //選擇左半部
  16   1        for(x_page=0; x_page<8 ;x_page++) //寫入8頁資料
  17   1         {
  18   2          LCD_Cmd(0x40+0);    //Y位址 
  19   2          LCD_Cmd(0xb8+x_page);           //寫入第0~7頁
  20   2           for(i=0; i< 16*4 ;i++)         //寫入32筆資料
  21   2           LCD_Data(qq[i*8+x_page]);     //寫入圖形
  22   2         }
  23   1      
  24   1        CS2=1; CS1=0;              //選擇右半部
  25   1        for(x_page=0; x_page<8 ;x_page++)  //寫入8頁資料
  26   1         {
  27   2           LCD_Cmd(0x40+0);        
  28   2           LCD_Cmd(0xb8+x_page);         //寫入第0~7頁
  29   2           for(i=0; i< 16*4 ;i++)          //寫入32筆資料
  30   2           LCD_Data(qq[i*8+512+x_page]); //寫入圖形
  31   2         }
  32   1        while(1);
  33   1      }
  34          /*******************************************
  35          *函數名稱: LCD_Cmd
  36          *功能描述: 寫入命令到繪圖型LCD
  37          *輸入參數：cmd
  38          *********************************************/
  39          void LCD_Cmd(unsigned char cmd)
  40          {
  41   1        unsigned char dly=40;
  42   1        Data=cmd; //輸出命令  
  43   1        D_I=0;RW=0;EN=1;while(dly--);EN=0; //寫入命令
  44   1        LCD_wait(); //等待忙碌旗標BF
  45   1      }
  46          /********************************************
  47          *函數名稱: LCD_Data
  48          *功能描述: 寫入資料到繪圖型LCD
  49          *輸入參數：dat
  50          *********************************************/
  51          void LCD_Data(char dat)
  52          {
  53   1        unsigned char dly=40;
  54   1        Data=dat;    //輸出資料
  55   1        D_I=1;RW=0;EN=1;while(dly--);EN=0;//寫入資料
C51 COMPILER V9.56.0.0   GLCD4                                                             03/04/2020 10:21:35 PAGE 2   

  56   1        LCD_wait(); //等待忙碌旗標BF
  57   1      }
  58          /**************************************************
  59          *函數名稱: LCD_wait
  60          *功能描述: LCD等待忙碌旗標BF
  61          ****************************************************/
  62          void LCD_wait(void)
  63          {
  64   1        unsigned char status;  //定義LCD讀取狀態
  65   1        Data=0xff; //P0設定為輸入埠
  66   1        do
  67   1        {
  68   2          D_I=0;RW=1;EN=1;//讀取命令
  69   2          status= Data; //輸入LCD的命令
  70   2          EN=0;     //禁能LCD
  71   2        }
  72   1        while(status & 0x80); //等待忙碌旗標BF=0
  73   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    364    ----
   CONSTANT SIZE    =   1024    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
