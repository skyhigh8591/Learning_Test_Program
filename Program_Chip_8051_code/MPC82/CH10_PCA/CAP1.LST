C51 COMPILER V9.03   CAP1                                                                  11/27/2011 16:05:32 PAGE 1   


C51 COMPILER V9.03, COMPILATION OF MODULE CAP1
OBJECT MODULE PLACED IN CAP1.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE CAP1.c OPTIMIZE(2,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /********** CAP1.c ********捕捉器實習範例****************
   2          *動作：令Timer0由T0CKO(P34)輸出方波,送到CEX0(P12)捕捉輸入
   3          *      ，在LED顯示時間差
   4          *硬體：SW1-3(P0LED)ON，將T0CKO(P34)連接到CEX0(P12)
   5          **********************************************/
   6          #include "..\MPC82.H"  //暫存器及組態定義
   7                                       //T0CKO頻率=Fosc/24/(256-TH0)
   8          #define T  0x14  //T0CKO頻率=22118400/24/T
   9          main()         
  10          {
  11   1        unsigned int first;   //第一次CCAP0捕捉時間
  12   1        P0M0=0; P0M1=0xFF; //設定P0為推挽式輸出(M0-1=01)
  13   1        AUXR2=T0CKOE; //致能T0CKO(P34)輸出方波
  14   1        TMOD=0x02;    //設定Timer0為mode2內部計時
  15   1        TH0=256-T;    //將計數值存入TH1
  16   1        TR0=1;        //啟動Timer1，不斷的由T0CKO(P34)輸出方波
  17   1        
  18   1        CCF0 = 0;              //清除模組0的比較旗標
  19   1        CCAPM0 = CAPP+CAPN; //CAPP=1，正緣或負緣觸發輸入時，CCAP0=(CH:CL)
  20   1        CR = 1;        //啟動PCA計數 
  21   1        while(1)
  22   1         {
  23   2               CL = CH =0;     //PCA計數器由0開始上數
  24   2               while(CCF0==0); //等待第一次觸發輸入
  25   2               CCF0 = 0;               //清除PCA模組0的旗標
  26   2               first=CCAP0L ;  //捕捉CPA計數值
  27   2              
  28   2               while(CCF0==0); //等待第二次觸發輸入
  29   2               CCF0 = 0;               //清除PCA模組0的旗標
  30   2               LED=~(CCAP0L-first) ;//將兩次CPA計數值的時間差(T)由LED輸出
  31   2         }    
  32   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    107    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
