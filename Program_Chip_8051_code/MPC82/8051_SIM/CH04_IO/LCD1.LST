C51 COMPILER V9.02   LCD1                                                                  01/07/2011 11:21:38 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE LCD1
OBJECT MODULE PLACED IN LCD1.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE LCD1.C OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /************** LCD1.C **********************************
   2          *動作：由LCD顯示兩行文字,令其閃爍或移位
   3          ***********************************************/
   4          #include "..\MPC82.H"   //暫存器及組態定義
   5          void main(void)
   6          {
   7   1         unsigned char i;        //資料計數
   8   1         LCD_init();    //重置及清除LCD    
   9   1         //LCD_Cmd(0x0F);//0000 1111
  10   1                         //bit2:D=1,顯示幕ON
  11   1                         //bit1:C=1,顯示游標
  12   1                             //bit0:B=1,游標閃爍
  13   1        //LCD_Cmd(0x04); //0000 0100,
  14   1                         //bit1:I/D=0，游標左移反向顯示
  15   1          
  16   1         LCD_Cmd(0x85); //游標由第一行第5個字開始顯示  
  17   1         for(i='0'; i<= '9';i++)//字元0~9 
  18   1          {
  19   2           LCD_Data(i);  //字元送到LCD顯示   
  20   2           Delay_ms(100);//延時，慢速逐一顯示
  21   2              }
  22   1      
  23   1         LCD_Cmd(0xC5); //游標由第二行第5個字開始顯示   
  24   1         for(i='A'; i<= 'J';i++)//LCD顯示字元A~J 
  25   1          {
  26   2               LCD_Data(i);  //字元送到LCD顯示   
  27   2           Delay_ms(100);//延時，慢速逐一顯示
  28   2              }
  29   1      
  30   1              while(1)   //不停的循環執行
  31   1           {  //選擇以下其中功能來執行
  32   2                 //LCD_Cmd(0x08); Delay_ms(500);//D=0關閉顯示器
  33   2             //LCD_Cmd(0x0c); Delay_ms(500);//D=1開啟顯示器
  34   2             //LCD_Cmd(0x1c); Delay_ms(100);//SC=1及RL=1顯示幕右移
  35   2             //LCD_Cmd(0x18); Delay_ms(100);//SC=1及RL=0顯示幕左移
  36   2           }  
  37   1      }
  38          /***********************************************************
  39          *函數名稱: LCD_Data
  40          *功能描述: 傳送資料到文字型LCD
  41          *輸入參數：dat
  42          ************************************************************/
  43          void LCD_Data(unsigned char dat)  //傳送資料到LCD
  44          {
  45   1          unsigned char dly=2;
  46   1              Data=dat;      //資料送到BUS
  47   1          RS=1;RW=0;EN=1;//資料寫入到LCD內
  48   1          while(dly--);
  49   1              EN=0;          //禁能LCD 
  50   1              LCD_wait();    //LCD等待寫入完成  
  51   1      }
  52          /***************************************************************
  53          *函數名稱: LCD_Cmd
  54          *功能描述: 傳送命令到文字型LCD
  55          *輸入參數：Cmd
C51 COMPILER V9.02   LCD1                                                                  01/07/2011 11:21:38 PAGE 2   

  56          ************************************************************/
  57          void LCD_Cmd(unsigned char Cmd) //傳送命令到LCD
  58          {
  59   1          unsigned char dly=2;
  60   1              Data=Cmd;       //命令送到BUS
  61   1          RS=0;RW=0;EN=1; //命令寫入到LCD內
  62   1          while(dly--);
  63   1          EN=0;           //禁能LCD
  64   1              LCD_wait(); //LCD等待寫入完成 
  65   1      }
  66          /***************************************************************
  67          *函數名稱: LCD_Cmd
  68          *功能描述: 傳送命令到文字型LCD
  69          *輸入參數：Cmd
  70          ************************************************************/
  71          void LCD_Cmd_Init(unsigned char Cmd) //傳送命令到LCD
  72          {
  73   1          Data=Cmd;       //命令送到BUS
  74   1          RS=0;RW=0;EN=1; //命令寫入到LCD內
  75   1          Delay_ms(1);
  76   1          EN=0;           //禁能LCD
  77   1          Delay_ms(1);
  78   1      }
  79          /***************************************************************
  80          *函數名稱: LCD_init
  81          *功能描述: 啟始化文字型LCD
  82          *****************************************************************/
  83          void LCD_init(void)    //LCD的啟始程式  
  84          {
  85   1          LCD_Cmd_Init(0x38);//0011 1000,8bit傳輸,顯示2行,5*7字型
  86   1          LCD_Cmd_Init(0x38);//bit4:DL=1,8bit傳輸,
  87   1          LCD_Cmd_Init(0x38);//bit3:N=1,顯示2行
  88   1                             //bit2:F=0,5*7字型    
  89   1          LCD_Cmd_Init(0x0c);/*0000 1100,顯示幕ON,不顯示游標,游標不閃爍
  90   1                          bit2:D=1,顯示幕ON
  91   1                          bit1:C=0,不顯示游標
  92   1                              bit0:B=0,游標不閃爍*/
  93   1          LCD_Cmd_Init(0x06);/*0000 0110,//顯示完游標右移,游標移位禁能 
  94   1                          bit1:I/D=1,顯示完游標右移,
  95   1                          bit0:S=0,游標移位禁能*/  
  96   1          LCD_Cmd_Init(0x01); //清除顯示幕  
  97   1          LCD_Cmd_Init(0x02); //游標回原位  
  98   1      }
  99          /**************************************************
 100          *函數名稱: LCD_wait
 101          *功能描述: LCD等待忙碌旗標BF
 102          ****************************************************/
 103          void LCD_wait(void)
 104          {
 105   1        unsigned char status;  //定義LCD讀取狀態
 106   1        Data=0xff; //P0設定為輸入埠
 107   1        do
 108   1        {
 109   2          RS=0;RW=1;EN=1;//讀取命令
 110   2          status= Data;       //輸入LCD的命令
 111   2          EN=0;                       //禁能LCD
 112   2        }
 113   1        while(status & 0x80); //等待忙碌旗標BF=0
 114   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.02   LCD1                                                                  01/07/2011 11:21:38 PAGE 3   

   CODE SIZE        =    251    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     11    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
