  Fri Jul 26 17:25:10 2002                                                                                               Page    1







               2500 A.D. 8051 Macro Assembler  -  Version 5.03b
               ------------------------------------------------

                       Input  Filename : LED322.a51
                       Output Filename : LED322.OBJ


    1                          	;
    2                          	; 配合"32個LED(共陽)實習板"
    3                          	;    P0所接的8個LED當二進制計數器,P1所接的8個LED依序亮熄著,並交互變化,
    4                          	;     P2所接的8個LED只有一LED亮著,並進行左旋的變化
    5                          	;     P3所接的8個LED只有一LED亮著,並進行右旋的變化
    6                          	;
    7          0020            	TP0:	EQU	020H
    8          0021            	TP1:	EQU	021H
    9          0022            	TP2:	EQU	022H
   10          0023            	TP3:	EQU	023H
   11   0000                   	START:
   12   0000   75 20 00        		MOV	TP0,#0
   13   0003   E5 20           		MOV	A,TP0
   14   0005   F4              		CPL	A
   15   0006   F5 80           		MOV	P0,A
   16   0008   75 21 55        		MOV	TP1,#55H
   17   000B   E5 21           		MOV	A,TP1
   18   000D   F4              		CPL	A
   19   000E   F5 90           		MOV	P1,A
   20   0010   75 22 01        		MOV	TP2,#1
   21   0013   E5 22           		MOV	A,TP2
   22   0015   F4              		CPL	A
   23   0016   F5 A0           		MOV	P2,A
   24   0018   75 23 01        		MOV	TP3,#1
   25   001B   E5 23           		MOV	A,TP3
   26   001D   F4              		CPL	A
   27   001E   F5 B0           		MOV	P3,A
   28   0020                   	LOOP:
   29   0020   05 20           		INC	TP0          ; P0當二進制計數器
   30   0022   E5 20           		MOV	A,TP0
   31   0024   F4              		CPL	A
   32   0025   F5 80           		MOV	P0,A
   33                          	
   34   0027   E5 21           		MOV	A,TP1        ; P1 0x55/0xaa交互變化
   35   0029   B4 55 05        		CJNE	A,#55H,FILL55H
   36   002C   75 21 AA        		MOV	TP1,#0AAH
   37   002F   01 34           		AJMP	NEXT1
   38   0031                   	FILL55H:
   39   0031   75 21 55        		MOV	TP1,#055H
   40   0034                   	NEXT1:
   41   0034   E5 21           		MOV	A,TP1
   42   0036   F4              		CPL	A
   43   0037   F5 90           		MOV	P1,A
   44                          	
   45   0039   E5 22           		MOV	A,TP2        ;P2左旋
   46   003B   23              		RL	A
   47   003C   F5 22           		MOV	TP2,A
  Fri Jul 26 17:25:10 2002                                                                                               Page    2




   48   003E   F4              		CPL	A
   49   003F   F5 A0           		MOV	P2,A
   50                          	
   51                          	
   52   0041   E5 23           		MOV	A,TP3        ;P3右旋
   53   0043   03              		RR	A
   54   0044   F5 23           		MOV	TP3,A
   55   0046   F4              		CPL	A
   56   0047   F5 B0           		MOV	P3,A
   57                          	
   58   0049   11 8D           		ACALL	DELAY100MS
   59   004B   80 D3           		SJMP	LOOP
   60                          	
   61   004D                   		include delay.inc
   62   004D                   	 include RDelay.inc
   63                          	;Simulator 專用副程式
   64                          	;使用R0, R1, R2, R3
   65                          	;
   66   004D                   	DELAY100US:
   67   004D   C0 E0           		PUSH	ACC
   68   004F   E9              		MOV	A,R1
   69   0050   C0 E0           		PUSH	ACC
   70   0052   79 2C           		MOV	R1,#44
   71   0054   D9 FE           		DJNZ	R1,$
   72   0056   D0 E0           		POP	ACC
   73   0058   F9              		MOV	R1,A
   74   0059   D0 E0           		POP	ACC
   75   005B   22              		RET
   76                          	;
   77   005C                   	DELAY1MS:
   78   005C   C0 E0           		PUSH	ACC
   79   005E   E9              		MOV	A,R1
   80   005F   C0 E0           		PUSH	ACC
   81   0061   79 FF           		MOV	R1,#255
   82   0063   D9 FE           		DJNZ	R1,$
   83   0065   79 EC           		MOV	R1,#236
   84   0067   D9 FE           		DJNZ	R1,$
   85   0069   D0 E0           		POP	ACC
   86   006B   F9              		MOV	R1,A
   87   006C   D0 E0           		POP	ACC
   88   006E   22              		RET
   89                          	;
   90   006F                   	DELAY10MS:
   91   006F   C0 E0           		PUSH	ACC
   92   0071   E8              		MOV	A,R0
   93   0072   C0 E0           		PUSH	ACC
   94   0074   E9              		MOV	A,R1
   95   0075   C0 E0           		PUSH	ACC
   96   0077   78 13           		MOV	R0,#19
   97   0079                   	DELAY10ms_1:
   98   0079   79 FF           		MOV	R1,#255
   99   007B   D9 FE           		DJNZ	R1,$
  100   007D   D8 FA           		DJNZ	R0,DELAY10ms_1
  101   007F   79 71           		MOV	R1,#113
  102   0081   D9 FE           		DJNZ	R1,$
  103   0083   00              		NOP
  104   0084   D0 E0           		POP	ACC
  Fri Jul 26 17:25:10 2002                                                                                               Page    3




  105   0086   F9              		MOV	R1,A
  106   0087   D0 E0           		POP	ACC
  107   0089   F8              		MOV	R0,A
  108   008A   D0 E0           		POP	ACC
  109   008C   22              		RET
  110                          	;
  111   008D                   	DELAY100MS:
  112   008D   C0 E0           		PUSH	ACC
  113   008F   E8              		MOV	A,R0
  114   0090   C0 E0           		PUSH	ACC
  115   0092   E9              		MOV	A,R1
  116   0093   C0 E0           		PUSH	ACC
  117   0095   78 C2           		MOV	R0,#194
  118   0097                   	DELAY100ms_1:
  119   0097   79 FF           		MOV	R1,#255
  120   0099   D9 FE           		DJNZ	R1,$
  121   009B   D8 FA           		DJNZ	R0,DELAY100ms_1
  122   009D   D0 E0           		POP	ACC
  123   009F   F9              		MOV	R1,A
  124   00A0   D0 E0           		POP	ACC
  125   00A2   F8              		MOV	R0,A
  126   00A3   D0 E0           		POP	ACC
  127   00A5   22              	        RET
  128                          	;
  129   00A6                   	DELAY1S:
  130   00A6   C0 E0           		PUSH	ACC
  131   00A8   EA              		MOV	A,R2
  132   00A9   C0 E0           		PUSH	ACC
  133   00AB   7A 0A           		MOV	R2,#10
  134   00AD                   	DELAY1s_1:
  135   00AD   12 00 8D        		LCALL	DELAY100MS
  136   00B0   DA FB           		DJNZ	R2,DELAY1s_1
  137   00B2   D0 E0           		POP	ACC
  138   00B4   FA              		MOV	R2,A
  139   00B5   D0 E0           		POP	ACC
  140   00B7   22              		RET
  141                          	;
  142   00B8                   	DELAY10S:
  143   00B8   C0 E0           		PUSH	ACC
  144   00BA   EA              		MOV	A,R2
  145   00BB   C0 E0           		PUSH	ACC
  146   00BD   7A 64           		MOV	R2,#100
  147   00BF                   	DELAY10s_1:
  148   00BF   12 00 8D        		LCALL	DELAY100MS
  149   00C2   DA FB           	 	DJNZ	R2,DELAY10s_1
  150   00C4   D0 E0           		POP	ACC
  151   00C6   FA              		MOV	R2,A
  152   00C7   D0 E0           		POP	ACC
  153   00C9   22              		RET
  154                          	;
  155   00CA                   	DELAY100S:
  156   00CA   C0 E0           		PUSH	ACC
  157   00CC   EB              		MOV	A,R3
  158   00CD   C0 E0           		PUSH	ACC
  159   00CF   7B 0A           		MOV	R3,#10
  160   00D1                   	DELAY100s_1:
  161   00D1   12 00 B8        		LCALL	DELAY10S
  Fri Jul 26 17:25:10 2002                                                                                               Page    4




  162   00D4   DB FB           		DJNZ	R3,DELAY100s_1
  163   00D6   D0 E0           		POP	ACC
  164   00D8   FA              		MOV	R2,A
  165   00D9   D0 E0           		POP	ACC
  166   00DB   22              		RET
  167                          	;
  168   00DC                   	DELAY100USP:
  169   00DC   C0 E0           		PUSH	ACC
  170   00DE   E9              		MOV	A,R1
  171   00DF   C0 E0           		PUSH	ACC
  172   00E1   EF              		MOV	A, R7
  173   00E2                   	DELAY100usP_1:
  174   00E2   79 2C           		MOV	R1,#44
  175   00E4   D9 FE           		DJNZ	R1,$
  176   00E6   D5 E0 F9        		DJNZ	ACC,DELAY100usP_1    
  177   00E9   D0 E0           		POP	ACC
  178   00EB   F9              		MOV	R1,A
  179   00EC   D0 E0           		POP	ACC
  180   00EE   22              		RET
  181                          	;
  182                          	
  183                          	
  184                          	
  185   00EF                   		END


             Lines Assembled : 185                  Errors : 0


