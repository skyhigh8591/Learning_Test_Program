C51 COMPILER V9.56.0.0   SEG4A                                                             03/04/2020 09:04:07 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE SEG4A
OBJECT MODULE PLACED IN SEG4A.OBJ
COMPILER INVOKED BY: C:\Keil_v51\C51\BIN\C51.EXE SEG4A.C OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*********** SEG4A.C ***************************
   2          *動作：由四位數七段顯示器顯示電子鐘的時、分及秒為閃爍
   3          *接線：Data=七段顯示器低電位輸出=Pgfedcba
   4          *      低電位掃描：S3~0=千、百、十、個位數 
   5          *硬體：SW1-1(SEG7)ON                            
   6          ***********************************************/
   7          #include "..\MPC82.H"   //暫存器及組態定義
   8          code unsigned char Table[] //七段顯示器0~9數碼資料
   9          ={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};
  10          
  11          char hor=23,min=58,sec=52; //設定時、分、秒時間
  12          void Display(char scan); //七段顯示器顯示時間值
  13          
  14          main()
  15          {   
  16   1        char scan=100;  //七段顯示器掃描次數，決時延時時間
  17   1        P0M0=0; P0M1=0xFF; //設定P0為推挽式輸出(M0-1=01)
  18   1        while(1)
  19   1         {
  20   2          Display(scan); //七段顯示器顯示時間
  21   2           if(KEY1==0) hor++;
  22   2           if(KEY2==0) min++;
  23   2           if(min>59){min=0;hor++;}
  24   2           if(hor>23)hor=0;
  25   2           
  26   2           
  27   2           
  28   2           
  29   2           
  30   2          sec++;               //秒加一
  31   2          if (sec < 60) continue; //若秒小於60到loop處   
  32   2          sec=0; min++;        //秒等於60則令秒=0，分加一
  33   2          if (min < 60) continue; //若分小於60到loop處   
  34   2          min=0; hor++;        //若分等於60則令分=0，時加一
  35   2          if (hor <24) continue; //若時小於24到loop處
  36   2          hor=0;min=0; sec=0; //若時等於24則令時、分、秒=0
  37   2         }
  38   1      }
  39          //***************************************************  
  40          void Display(char scan) //四位數七段顯示器顯示步數   
  41          {  
  42   1        
  43   1        while(scan--) //重覆掃描次數 
  44   1         {
  45   2           S0=S1=S2=S3=1; //遮沒 
  46   2           Data=~Table[min%10];//讀取分個位數數碼資料輸出
  47   2           S0=0;      //選擇個位數顯示器
  48   2           Delay_ms(1);   //掃描延時  
  49   2             
  50   2           S0=S1=S2=S3=1; //遮沒          
  51   2           Data=~Table[min/10];//讀取分十位數數碼資料輸出
  52   2           S1=0;      //選擇十位數顯示器
  53   2           Delay_ms(1);   //掃描延時
  54   2             
  55   2           S0=S1=S2=S3=1; //遮沒                     
C51 COMPILER V9.56.0.0   SEG4A                                                             03/04/2020 09:04:07 PAGE 2   

  56   2           if(scan<50) Data=~Table[hor%10];//讀取時個數及秒閃爍輸出
  57   2            else Data=~(Table[hor%10] | 0x80);//讀取時十數及秒閃爍輸出
  58   2         S2=0;      //選擇百位數顯示器
  59   2           Delay_ms(1);   //掃描延時
  60   2             
  61   2           S0=S1=S2=S3=1; //遮沒
  62   2           Data=~Table[hor/10];//讀取分十位數數碼資料輸出
  63   2           S3=0;      //選擇千位數顯示器
  64   2           Delay_ms(1);   //掃描延時
  65   2         }     
  66   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    403    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
