C51 COMPILER V9.03   PCA3                                                                  11/27/2011 14:37:49 PAGE 1   


C51 COMPILER V9.03, COMPILATION OF MODULE PCA3
OBJECT MODULE PLACED IN PCA3.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE PCA3.C OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /******* PCA3.C*********PCA溢位中斷範例********
   2          *動作：PCA計數時脈來源為Timer0的PCA計數溢位中斷延時
   3          *      ，令SPEAK(P10)反相輸出
   4          *硬體：高頻SW2-5(SPK)ON,低頻SW1-4(P1LED)ON
   5          ***********************************************/
   6          #include "..\MPC82.H"   //暫存器及組態定義
   7          //Fosc=22.1184MHz，PCA計數時脈=Fosc/12=1.8432MHz
   8          #define T  14400  //PCA延時時間=(1/1.8432MHz)*14400=7812.5uS
   9          main()         
  10          {
  11   1        CMOD=ECF+CPS1;  //致能PCA溢位中斷，CPS1-0=10,設定由Timer0溢位時脈提供PCA計數
  12   1              
  13   1        TMOD=0x02; //設定使用Timer0的mode2(8-bit自動載入)
  14   1        TH0=256-128; //設定PCA計數時脈來源,PCA延時時間=128*7812.5uS=1秒
  15   1        TR0=1;         //開始Timer0計時
  16   1      
  17   1        CL= (65536-T) % 256; //將低8-bit計數值存入CL 
  18   1        CH= (65536-T) / 256; //將高8-bit計數值存入CH
  19   1        EA = 1;              //致能所有中斷
  20   1        AUXIE = EPCA;        //致能PCA中斷
  21   1        CR=1;       //啟動PCA計數
  22   1        while(1);   //自我空轉
  23   1      }
  24          /***********************************************************
  25          *函數名稱: PCA中斷函數
  26          *功能描述: 自動令CEX0反相
  27          ************************************************************/
  28          void PCA_Interrupt() interrupt 10
  29          {
  30   1         SPEAK=!SPEAK;         //SPEAK反相
  31   1         CL= (65536-T) % 256; //將低8-bit計數值存入CL 
  32   1         CH= (65536-T) / 256; //將高8-bit計數值存入CH
  33   1         CF=0;          //若計時CF=1，清除PCA溢位旗標CF=0 
  34   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     83    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
