Intel-8051 Macro Assembler - Version 1.00

      1    0000                           ;
      2    0000                           ; 配合"32個LED(共陽)實習板"
      3    0000                           ;    P0所接的8個LED當二進制計數器,P1所接的8個LED依序亮熄著,並交互變化,
      4    0000                           ;     P2所接的8個LED只有一LED亮著,並進行左旋的變化
      5    0000                           ;     P3所接的8個LED只有一LED亮著,並進行右旋的變化
      6    0000                           ;
      7    0000                           TP0:	EQU	020H
      8    0000                           TP1:	EQU	021H
      9    0000                           TP2:	EQU	022H
     10    0000                           TP3:	EQU	023H
     11    0000                           START:
     12    0000     75 20 00              	MOV	TP0,#0
     13    0003     E5 20                 	MOV	A,TP0
     14    0005     F4                    	CPL	A
     15    0006     F5 80                 	MOV	P0,A
     16    0008     75 21 55              	MOV	TP1,#55H
     17    000B     E5 21                 	MOV	A,TP1
     18    000D     F4                    	CPL	A
     19    000E     F5 90                 	MOV	P1,A
     20    0010     75 22 01              	MOV	TP2,#1
     21    0013     E5 22                 	MOV	A,TP2
     22    0015     F4                    	CPL	A
     23    0016     F5 A0                 	MOV	P2,A
     24    0018     75 23 01              	MOV	TP3,#1
     25    001B     E5 23                 	MOV	A,TP3
     26    001D     F4                    	CPL	A
     27    001E     F5 B0                 	MOV	P3,A
     28    0020                           LOOP:
     29    0020     05 20                 	INC	TP0          ; P0當二進制計數器
     30    0022     E5 20                 	MOV	A,TP0
     31    0024     F4                    	CPL	A
     32    0025     F5 80                 	MOV	P0,A
     33    0027                           
     34    0027     E5 21                 	MOV	A,TP1        ; P1 0x55/0xaa交互變化
     35    0029     B4 55 05              	CJNE	A,#55H,FILL55H
     36    002C     75 21 AA              	MOV	TP1,#0AAH
     37    002F     01 34                 	AJMP	NEXT1
     38    0031                           FILL55H:
     39    0031     75 21 55              	MOV	TP1,#055H
     40    0034                           NEXT1:
     41    0034     E5 21                 	MOV	A,TP1
     42    0036     F4                    	CPL	A
     43    0037     F5 90                 	MOV	P1,A
     44    0039                           
     45    0039     E5 22                 	MOV	A,TP2        ;P2左旋
     46    003B     23                    	RL	A
     47    003C     F5 22                 	MOV	TP2,A
     48    003E     F4                    	CPL	A
     49    003F     F5 A0                 	MOV	P2,A
     50    0041                           
     51    0041                           
     52    0041     E5 23                 	MOV	A,TP3        ;P3右旋
     53    0043     03                    	RR	A
     54    0044     F5 23                 	MOV	TP3,A
     55    0046     F4                    	CPL	A
     56    0047     F5 B0                 	MOV	P3,A
     57    0049                           
     58    0049     11 8D                 	ACALL	DELAY100MS
     59    004B     80 D3                 	SJMP	LOOP
     60    004D                           
     61    004D                           	include delay.inc
I1    1    004D                            include RDelay.inc
I2    1    004D                           ;Simulator 專用副程式
I2    2    004D                           ;使用R0, R1, R2, R3
I2    3    004D                           ;
I2    4    004D                           DELAY100US:
I2    5    004D     C0 E0                 	PUSH	ACC
I2    6    004F     E9                    	MOV	A,R1
I2    7    0050     C0 E0                 	PUSH	ACC
I2    8    0052     79 2C                 	MOV	R1,#44
I2    9    0054     D9 FE                 	DJNZ	R1,$
I2   10    0056     D0 E0                 	POP	ACC
I2   11    0058     F9                    	MOV	R1,A
I2   12    0059     D0 E0                 	POP	ACC
I2   13    005B     22                    	RET
I2   14    005C                           ;
I2   15    005C                           DELAY1MS:
I2   16    005C     C0 E0                 	PUSH	ACC
I2   17    005E     E9                    	MOV	A,R1
I2   18    005F     C0 E0                 	PUSH	ACC
I2   19    0061     79 FF                 	MOV	R1,#255
I2   20    0063     D9 FE                 	DJNZ	R1,$
I2   21    0065     79 EC                 	MOV	R1,#236
I2   22    0067     D9 FE                 	DJNZ	R1,$
I2   23    0069     D0 E0                 	POP	ACC
I2   24    006B     F9                    	MOV	R1,A
I2   25    006C     D0 E0                 	POP	ACC
I2   26    006E     22                    	RET
I2   27    006F                           ;
I2   28    006F                           DELAY10MS:
I2   29    006F     C0 E0                 	PUSH	ACC
I2   30    0071     E8                    	MOV	A,R0
I2   31    0072     C0 E0                 	PUSH	ACC
I2   32    0074     E9                    	MOV	A,R1
I2   33    0075     C0 E0                 	PUSH	ACC
I2   34    0077     78 13                 	MOV	R0,#19
I2   35    0079                           DELAY10ms_1:
I2   36    0079     79 FF                 	MOV	R1,#255
I2   37    007B     D9 FE                 	DJNZ	R1,$
I2   38    007D     D8 FA                 	DJNZ	R0,DELAY10ms_1
I2   39    007F     79 71                 	MOV	R1,#113
I2   40    0081     D9 FE                 	DJNZ	R1,$
I2   41    0083     00                    	NOP
I2   42    0084     D0 E0                 	POP	ACC
I2   43    0086     F9                    	MOV	R1,A
I2   44    0087     D0 E0                 	POP	ACC
I2   45    0089     F8                    	MOV	R0,A
I2   46    008A     D0 E0                 	POP	ACC
I2   47    008C     22                    	RET
I2   48    008D                           ;
I2   49    008D                           DELAY100MS:
I2   50    008D     C0 E0                 	PUSH	ACC
I2   51    008F     E8                    	MOV	A,R0
I2   52    0090     C0 E0                 	PUSH	ACC
I2   53    0092     E9                    	MOV	A,R1
I2   54    0093     C0 E0                 	PUSH	ACC
I2   55    0095     78 C2                 	MOV	R0,#194
I2   56    0097                           DELAY100ms_1:
I2   57    0097     79 FF                 	MOV	R1,#255
I2   58    0099     D9 FE                 	DJNZ	R1,$
I2   59    009B     D8 FA                 	DJNZ	R0,DELAY100ms_1
I2   60    009D     D0 E0                 	POP	ACC
I2   61    009F     F9                    	MOV	R1,A
I2   62    00A0     D0 E0                 	POP	ACC
I2   63    00A2     F8                    	MOV	R0,A
I2   64    00A3     D0 E0                 	POP	ACC
I2   65    00A5     22                            RET
I2   66    00A6                           ;
I2   67    00A6                           DELAY1S:
I2   68    00A6     C0 E0                 	PUSH	ACC
I2   69    00A8     EA                    	MOV	A,R2
I2   70    00A9     C0 E0                 	PUSH	ACC
I2   71    00AB     7A 0A                 	MOV	R2,#10
I2   72    00AD                           DELAY1s_1:
I2   73    00AD     12 00 8D              	LCALL	DELAY100MS
I2   74    00B0     DA FB                 	DJNZ	R2,DELAY1s_1
I2   75    00B2     D0 E0                 	POP	ACC
I2   76    00B4     FA                    	MOV	R2,A
I2   77    00B5     D0 E0                 	POP	ACC
I2   78    00B7     22                    	RET
I2   79    00B8                           ;
I2   80    00B8                           DELAY10S:
I2   81    00B8     C0 E0                 	PUSH	ACC
I2   82    00BA     EA                    	MOV	A,R2
I2   83    00BB     C0 E0                 	PUSH	ACC
I2   84    00BD     7A 64                 	MOV	R2,#100
I2   85    00BF                           DELAY10s_1:
I2   86    00BF     12 00 8D              	LCALL	DELAY100MS
I2   87    00C2     DA FB                  	DJNZ	R2,DELAY10s_1
I2   88    00C4     D0 E0                 	POP	ACC
I2   89    00C6     FA                    	MOV	R2,A
I2   90    00C7     D0 E0                 	POP	ACC
I2   91    00C9     22                    	RET
I2   92    00CA                           ;
I2   93    00CA                           DELAY100S:
I2   94    00CA     C0 E0                 	PUSH	ACC
I2   95    00CC     EB                    	MOV	A,R3
I2   96    00CD     C0 E0                 	PUSH	ACC
I2   97    00CF     7B 0A                 	MOV	R3,#10
I2   98    00D1                           DELAY100s_1:
I2   99    00D1     12 00 B8              	LCALL	DELAY10S
I2  100    00D4     DB FB                 	DJNZ	R3,DELAY100s_1
I2  101    00D6     D0 E0                 	POP	ACC
I2  102    00D8     FA                    	MOV	R2,A
I2  103    00D9     D0 E0                 	POP	ACC
I2  104    00DB     22                    	RET
I2  105    00DC                           ;
I2  106    00DC                           DELAY100USP:
I2  107    00DC     C0 E0                 	PUSH	ACC
I2  108    00DE     E9                    	MOV	A,R1
I2  109    00DF     C0 E0                 	PUSH	ACC
I2  110    00E1     EF                    	MOV	A, R7
I2  111    00E2                           DELAY100usP_1:
I2  112    00E2     79 2C                 	MOV	R1,#44
I2  113    00E4     D9 FE                 	DJNZ	R1,$
I2  114    00E6     D5 E0 F9              	DJNZ	ACC,DELAY100usP_1    
I2  115    00E9     D0 E0                 	POP	ACC
I2  116    00EB     F9                    	MOV	R1,A
I2  117    00EC     D0 E0                 	POP	ACC
I2  118    00EE     22                    	RET
I2  119    00EF                           ;
I1    2    00EF                           
     62    00EF                           
     63    00EF                           
     64    00EF                           	END
